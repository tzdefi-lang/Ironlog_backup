@import "tailwindcss";
@custom-variant dark (&:where(.dark, .dark *));

/* Global polish for the PWA */
:root {
  /* Reduce the bright iOS tap highlight */
  -webkit-tap-highlight-color: rgba(0, 0, 0, 0);
  --ease-smooth: cubic-bezier(0.2, 0.72, 0.2, 1);
  --ease-spring: cubic-bezier(0.18, 0.9, 0.22, 1.08);
  --dur-fast: 150ms;
  --dur-med: 220ms;
  --dur-slow: 280ms;
  --app-bg: #ffffff;
  --app-fg: #111827;
  --surface-muted: #f9fafb;
  --nav-shadow: rgba(17, 24, 39, 0.06);
  --accent-glow-soft: rgba(245, 158, 11, 0.34);
  --accent-glow-strong: rgba(245, 158, 11, 0.42);
  --chart-tooltip-bg: rgba(255, 255, 255, 0.9);
  --chart-tooltip-border: rgba(148, 163, 184, 0.28);
  --chart-tooltip-shadow: rgba(15, 23, 42, 0.14);
  --chart-tooltip-label: #0f172a;
  --chart-tooltip-text: #334155;
}

html.dark {
  --app-bg: #030712;
  --app-fg: #f3f4f6;
  --surface-muted: #111827;
  --nav-shadow: rgba(2, 6, 23, 0.45);
  --accent-glow-soft: rgba(245, 158, 11, 0.24);
  --accent-glow-strong: rgba(245, 158, 11, 0.34);
  --chart-tooltip-bg: rgba(17, 24, 39, 0.88);
  --chart-tooltip-border: rgba(71, 85, 105, 0.45);
  --chart-tooltip-shadow: rgba(2, 6, 23, 0.45);
  --chart-tooltip-label: #f8fafc;
  --chart-tooltip-text: #e2e8f0;
}

@media (prefers-color-scheme: dark) {
  html:not(.light):not(.dark) {
    --app-bg: #030712;
    --app-fg: #f3f4f6;
    --surface-muted: #111827;
    --nav-shadow: rgba(2, 6, 23, 0.45);
    --accent-glow-soft: rgba(245, 158, 11, 0.24);
    --accent-glow-strong: rgba(245, 158, 11, 0.34);
    --chart-tooltip-bg: rgba(17, 24, 39, 0.88);
    --chart-tooltip-border: rgba(71, 85, 105, 0.45);
    --chart-tooltip-shadow: rgba(2, 6, 23, 0.45);
    --chart-tooltip-label: #f8fafc;
    --chart-tooltip-text: #e2e8f0;
  }
}

html, body {
  height: 100%;
  background: var(--app-bg);
  color: var(--app-fg);
  /* Prefer Apple system font on iOS/macOS; fall back cleanly elsewhere */
  font-family: -apple-system, BlinkMacSystemFont, "SF Pro Text", "SF Pro Display", system-ui, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
  overscroll-behavior: none;
}

#root {
  height: 100%;
}

input, button, textarea, select {
  font: inherit;
}

a, button {
  transition:
    color var(--dur-fast) var(--ease-smooth),
    background-color var(--dur-fast) var(--ease-smooth),
    border-color var(--dur-fast) var(--ease-smooth),
    transform var(--dur-fast) var(--ease-smooth),
    box-shadow var(--dur-med) var(--ease-smooth),
    filter var(--dur-fast) var(--ease-smooth),
    opacity var(--dur-fast) var(--ease-smooth);
}

/* Keep scrolling feeling native */
body {
  margin: 0;
  overflow: hidden;
}

/* Only specific content regions should scroll */
.scroll-area {
  overflow-y: auto;
  -webkit-overflow-scrolling: touch;
  overscroll-behavior: contain;
}

/* Hide browser focus outlines on Recharts surfaces when tapping/clicking charts. */
.recharts-wrapper:focus,
.recharts-wrapper:focus-visible,
.recharts-surface:focus,
.recharts-surface:focus-visible,
.recharts-pie:focus,
.recharts-pie:focus-visible,
.recharts-pie-sector:focus,
.recharts-pie-sector:focus-visible {
  outline: none !important;
  box-shadow: none !important;
}

/* Harmonize all chart tooltips with app card style (soft, rounded, low-contrast). */
.recharts-default-tooltip {
  background: var(--chart-tooltip-bg) !important;
  border: 1px solid var(--chart-tooltip-border) !important;
  border-radius: 16px !important;
  box-shadow: 0 10px 24px var(--chart-tooltip-shadow) !important;
  backdrop-filter: blur(8px);
  -webkit-backdrop-filter: blur(8px);
  padding: 10px 12px !important;
}

.recharts-tooltip-label {
  margin-bottom: 6px !important;
  color: var(--chart-tooltip-label) !important;
  font-size: 13px !important;
  font-weight: 800 !important;
  letter-spacing: 0.02em;
}

.recharts-tooltip-item {
  padding: 0 !important;
  color: var(--chart-tooltip-text) !important;
  font-size: 13px !important;
  font-weight: 700 !important;
}

/* Quick "pop" feedback for taps (used on bottom-nav + key buttons) */
@keyframes tap-pop {
  0% { transform: scale(1); }
  35% { transform: scale(0.88); }
  70% { transform: scale(1.06); }
  100% { transform: scale(1); }
}

/* Apply a quick, satisfying pop on press */
.pressable {
  will-change: transform;
  transform: translateZ(0);
}

.pressable:active {
  animation: tap-pop 220ms cubic-bezier(0.2, 0.8, 0.2, 1);
}

.tap-pop {
  animation: tap-pop 220ms cubic-bezier(0.2, 0.8, 0.2, 1);
}

.view-enter {
  animation: view-enter var(--dur-med) var(--ease-spring) both;
}

@keyframes view-enter {
  0% {
    opacity: 0;
    transform: translate3d(0, 18px, 0) scale(0.988);
    filter: saturate(0.9);
  }
  100% {
    opacity: 1;
    transform: translate3d(0, 0, 0) scale(1);
    filter: saturate(1);
  }
}

.page-shell {
  height: 100%;
}

.page-shell--enter {
  animation: page-shell-in 170ms var(--ease-spring) backwards;
}

.page-shell--exit {
  will-change: opacity, transform, filter;
  animation: page-shell-out 120ms cubic-bezier(0.4, 0, 0.8, 0.2) both;
}

@keyframes page-shell-in {
  0% {
    opacity: 0;
    transform: translate3d(0, 14px, 0);
    filter: blur(1.5px);
  }
  100% {
    opacity: 1;
    transform: translate3d(0, 0, 0);
    filter: blur(0);
  }
}

@keyframes page-shell-out {
  0% {
    opacity: 1;
    transform: translate3d(0, 0, 0);
    filter: blur(0);
  }
  100% {
    opacity: 0;
    transform: translate3d(0, -8px, 0);
    filter: blur(1px);
  }
}

.calendar-month-frame {
  will-change: transform, opacity, filter;
}

.calendar-month-frame--next {
  animation: calendar-month-next 220ms var(--ease-smooth) both;
}

.calendar-month-frame--prev {
  animation: calendar-month-prev 220ms var(--ease-smooth) both;
}

@keyframes calendar-month-next {
  0% {
    opacity: 0.2;
    transform: translate3d(26px, 0, 0);
    filter: blur(1px);
  }
  100% {
    opacity: 1;
    transform: translate3d(0, 0, 0);
    filter: blur(0);
  }
}

@keyframes calendar-month-prev {
  0% {
    opacity: 0.2;
    transform: translate3d(-26px, 0, 0);
    filter: blur(1px);
  }
  100% {
    opacity: 1;
    transform: translate3d(0, 0, 0);
    filter: blur(0);
  }
}

.card-lift {
  transform: translateZ(0);
  transition:
    transform var(--dur-fast) var(--ease-smooth),
    box-shadow var(--dur-med) var(--ease-smooth),
    border-color var(--dur-fast) var(--ease-smooth),
    filter var(--dur-fast) var(--ease-smooth);
}

.card-lift:hover {
  transform: translate3d(0, -2px, 0);
  filter: saturate(1.02);
}

.card-lift:active {
  transform: translate3d(0, 0, 0) scale(0.985);
}

.list-stagger > * {
  opacity: 0;
  transform: translate3d(0, 10px, 0) scale(0.99);
  animation: list-item-in var(--dur-slow) var(--ease-spring) forwards;
}

.list-stagger > *:nth-child(1) { animation-delay: 16ms; }
.list-stagger > *:nth-child(2) { animation-delay: 28ms; }
.list-stagger > *:nth-child(3) { animation-delay: 40ms; }
.list-stagger > *:nth-child(4) { animation-delay: 52ms; }
.list-stagger > *:nth-child(5) { animation-delay: 64ms; }
.list-stagger > *:nth-child(6) { animation-delay: 76ms; }
.list-stagger > *:nth-child(7) { animation-delay: 88ms; }
.list-stagger > *:nth-child(8) { animation-delay: 100ms; }
.list-stagger > *:nth-child(9) { animation-delay: 112ms; }
.list-stagger > *:nth-child(10) { animation-delay: 124ms; }
.list-stagger > *:nth-child(11) { animation-delay: 136ms; }
.list-stagger > *:nth-child(12) { animation-delay: 148ms; }

@keyframes list-item-in {
  0% {
    opacity: 0;
    transform: translate3d(0, 10px, 0) scale(0.99);
  }
  100% {
    opacity: 1;
    transform: translate3d(0, 0, 0) scale(1);
  }
}

.modal-backdrop {
  will-change: opacity, backdrop-filter;
}

.modal-backdrop--enter {
  animation: modal-backdrop-in 240ms var(--ease-smooth) both;
}

.modal-backdrop--exit {
  animation: modal-backdrop-out 180ms var(--ease-smooth) both;
}

.modal-panel {
  will-change: opacity, transform, filter;
}

.modal-panel--enter {
  animation: modal-panel-in var(--dur-med) var(--ease-spring) both;
}

.modal-panel--exit {
  animation: modal-panel-out 170ms cubic-bezier(0.42, 0, 1, 1) both;
}

.exercise-picker-modal-overlay.modal-backdrop--enter {
  animation: modal-backdrop-in 200ms var(--ease-smooth) both;
}

.exercise-picker-modal-overlay.modal-backdrop--exit {
  animation: modal-backdrop-out 220ms var(--ease-smooth) both;
}

.exercise-picker-modal-panel.modal-panel--enter {
  animation: exercise-picker-panel-in 260ms var(--ease-spring) both;
}

.exercise-picker-modal-panel.modal-panel--exit {
  animation: exercise-picker-panel-out 220ms cubic-bezier(0.32, 0, 0.67, 0) both;
}

@keyframes modal-backdrop-in {
  from { opacity: 0; }
  to { opacity: 1; }
}

@keyframes modal-backdrop-out {
  from { opacity: 1; }
  to { opacity: 0; }
}

@keyframes modal-panel-in {
  0% {
    opacity: 0;
    transform: translate3d(0, 16px, 0) scale(0.97);
    filter: blur(1px);
  }
  100% {
    opacity: 1;
    transform: translate3d(0, 0, 0) scale(1);
    filter: blur(0);
  }
}

@keyframes modal-panel-out {
  0% {
    opacity: 1;
    transform: translate3d(0, 0, 0) scale(1);
    filter: blur(0);
  }
  100% {
    opacity: 0;
    transform: translate3d(0, 10px, 0) scale(0.98);
    filter: blur(1px);
  }
}

@keyframes exercise-picker-panel-in {
  0% {
    opacity: 0;
    transform: translate3d(0, 22px, 0) scale(0.96);
    filter: blur(1px);
  }
  100% {
    opacity: 1;
    transform: translate3d(0, 0, 0) scale(1);
    filter: blur(0);
  }
}

@keyframes exercise-picker-panel-out {
  0% {
    opacity: 1;
    transform: translate3d(0, 0, 0) scale(1);
    filter: blur(0);
  }
  100% {
    opacity: 0;
    transform: translate3d(0, 20px, 0) scale(0.97);
    filter: blur(1px);
  }
}

.action-sheet-overlay {
  animation: modal-backdrop-in 240ms var(--ease-smooth) both;
}

.action-sheet-panel {
  will-change: transform, opacity;
  animation: action-sheet-in 360ms var(--ease-spring) both;
}

@keyframes action-sheet-in {
  from {
    opacity: 0;
    transform: translate3d(0, 28px, 0);
  }
  to {
    opacity: 1;
    transform: translate3d(0, 0, 0);
  }
}

.float-glow {
  animation: float-glow 2.8s ease-in-out infinite;
}

@keyframes float-glow {
  0%, 100% {
    box-shadow: 0 10px 30px var(--accent-glow-soft);
    transform: translate3d(0, 0, 0);
  }
  50% {
    box-shadow: 0 16px 36px var(--accent-glow-strong);
    transform: translate3d(0, -2px, 0);
  }
}

.bottom-nav-shell {
  backdrop-filter: blur(14px);
  box-shadow: 0 -8px 28px var(--nav-shadow);
}

.bottom-nav-link[data-active='true'] {
  transform: translate3d(0, -2px, 0);
}

.bottom-nav-link svg {
  transition: transform var(--dur-fast) var(--ease-smooth);
}

.bottom-nav-link:hover svg {
  transform: translate3d(0, -1px, 0);
}

/* "Score" reveal used in the session report */
@keyframes score-pop {
  0% { transform: scale(0.94); opacity: 0.0; }
  55% { transform: scale(1.08); opacity: 1; }
  100% { transform: scale(1); opacity: 1; }
}

.score-pop {
  animation: score-pop 360ms cubic-bezier(0.2, 0.9, 0.2, 1);
}

@media (prefers-reduced-motion: reduce) {
  *, *::before, *::after {
    animation-duration: 1ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 1ms !important;
    scroll-behavior: auto !important;
  }
}
